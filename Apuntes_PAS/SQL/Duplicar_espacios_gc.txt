--CÓMO DUPLICAR UN ESPACIO (EN CONCRETO EL PAS Y VERLO DUPLICADO EN EL PDI)

-- CREAR TABLA POR_CCONTEN02 CON CONTENIDO DE PDI ÚNICAMENTE, Y UN CAMPO IDENTI_PAS AUXILIAR PARA SABER CUAL ERA EL IDENTI ORIGINAL (POSTERIOR UPDATE DEL PADRE)
CREATE TABLE POR_CCONTEN02(IDENTI, IDENTI_PAS,
ALIURI,
FECACT,
FECCAM,
USUCAM,
FECCRE,
USUCRE,
DESCRI,
IDIOMA,
ORDIND,
PADRE,
FECIPU,
FECFPU,
ESPACI,
ESTADO,
TITULO,
TIPO,
CONTEN,
TEMPLA,
PERGSP,
TITHTM,
PALCLA,
OBSERV)
AS
(SELECT SEC_POR_CCONTEN01_IDENTI.NEXTVAL,IDENTI,ALIURI,
FECACT,
FECCAM,
USUCAM,
FECCRE,
USUCRE,
DESCRI,
IDIOMA,
ORDIND,
PADRE,
FECIPU,
FECFPU,
3,
ESTADO,
TITULO,
TIPO,
CONTEN,
TEMPLA,
PERGSP,
TITHTM,
PALCLA,
OBSERV FROM (select IDENTI, ALIURI,
FECACT,
FECCAM,
USUCAM,
FECCRE,
USUCRE,
DESCRI,
IDIOMA,
ORDIND,
PADRE,
FECIPU,
FECFPU,
3,
ESTADO,
TITULO,
TIPO,
CONTEN,
TEMPLA,
PERGSP,
TITHTM,
PALCLA,
OBSERV FROM POR_CCONTEN01 WHERE ESPACI=2 ORDER BY IDENTI));


-- CAMBIAR PADRE IDENTI ANTIGUO (PAS) POR IDENTI NUEVO (PDI)
UPDATE POR_CCONTEN02 A SET A.PADRE = (SELECT B.IDENTI FROM POR_CCONTEN02 B WHERE A.PADRE=B.IDENTI_PAS);

-- BORRAR CAMPO IDENTI_PAS
ALTER TABLE POR_CCONTEN02 DROP COLUMN IDENTI_PAS;

-- COPIAR POR_CCONTEN01 COMO POR_CCONTEN03

-- AÑADIR A POR_CCONTEN03 REGISTROS DE POR_CCONTEN02
INSERT INTO POR_CCONTEN03(SELECT * FROM POR_CCONTEN02);

(LA TABLA POR_CCONTEN03 SERÍA LA DEFINITIVA)


